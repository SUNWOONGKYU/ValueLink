<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DCF Í∏∞ÏóÖÍ∞ÄÏπò ÌèâÍ∞Ä | ValueLink</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --deep-blue: #1D4ED8;
            --deep-blue-light: #3B82F6;
            --deep-blue-pale: #DBEAFE;
            --text-primary: #111827;
            --text-secondary: #374151;
            --text-muted: #6B7280;
            --bg-light: #F3F4F6;
            --white: #FFFFFF;
            --border: #E5E7EB;
            --success: #10B981;
            --error: #EF4444;
        }

        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-primary);
        }

        /* HEADER */
        header {
            background: var(--white);
            border-bottom: 1px solid var(--border);
            padding: 0 40px;
            height: 72px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 48px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }

        .logo-symbol { width: 44px; height: 44px; }
        .logo-text { font-size: 24px; font-weight: 700; color: #1E3A5F; }

        .main-nav {
            display: flex;
            gap: 8px;
        }

        .nav-item {
            padding: 10px 20px;
            font-size: 15px;
            font-weight: 600;
            text-decoration: none;
            color: var(--text-secondary);
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .nav-item:hover {
            background: var(--bg-light);
        }

        /* BREADCRUMB */
        .breadcrumb-container {
            background: var(--white);
            border-bottom: 1px solid var(--border);
            padding: 12px 40px;
        }

        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: var(--text-muted);
            max-width: 1200px;
            margin: 0 auto;
        }

        .breadcrumb a {
            color: var(--deep-blue);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        .breadcrumb a:hover {
            color: var(--deep-blue-light);
        }

        .breadcrumb span {
            color: var(--text-muted);
        }

        /* MAIN */
        .main-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
        }

        .page-title {
            margin-bottom: 32px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }

        .page-title-content h1 {
            font-size: 28px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .page-title-content p {
            font-size: 15px;
            color: var(--text-muted);
        }

        .btn-portal {
            padding: 12px 24px;
            font-size: 14px;
            font-weight: 600;
            color: var(--white);
            background: var(--success);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-portal:hover {
            background: #059669;
            transform: translateY(-1px);
        }

        /* FORM LAYOUT */
        .form-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .form-section {
            background: var(--white);
            border-radius: 16px;
            padding: 28px;
        }

        .form-section h2 {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--border);
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            font-size: 13px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 6px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 14px;
            font-size: 14px;
            border: 1px solid var(--border);
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--deep-blue);
            box-shadow: 0 0 0 3px var(--deep-blue-pale);
        }

        .form-group .unit {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        /* PROJECTION TABLE */
        .projection-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 12px;
        }

        .projection-table th,
        .projection-table td {
            padding: 10px 8px;
            text-align: right;
            font-size: 13px;
            border-bottom: 1px solid var(--border);
        }

        .projection-table th {
            background: var(--bg-light);
            font-weight: 600;
            color: var(--text-secondary);
        }

        .projection-table td:first-child,
        .projection-table th:first-child {
            text-align: left;
        }

        .projection-table input {
            width: 100%;
            padding: 8px;
            font-size: 13px;
            border: 1px solid var(--border);
            border-radius: 4px;
            text-align: right;
        }

        /* BUTTONS */
        .btn-calculate {
            width: 100%;
            padding: 16px;
            font-size: 16px;
            font-weight: 600;
            color: var(--white);
            background: var(--deep-blue);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-top: 24px;
        }

        .btn-calculate:hover {
            background: #1E40AF;
        }

        .btn-calculate:disabled {
            background: var(--text-muted);
            cursor: not-allowed;
        }

        /* RESULT SECTION */
        .result-section {
            grid-column: 1 / -1;
            background: var(--white);
            border-radius: 16px;
            padding: 28px;
            display: none;
        }

        .result-section.show {
            display: block;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border);
        }

        .result-header h2 {
            font-size: 20px;
            font-weight: 700;
        }

        .result-summary {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }

        .summary-card {
            background: var(--bg-light);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }

        .summary-card.highlight {
            background: var(--deep-blue);
            color: var(--white);
        }

        .summary-card label {
            display: block;
            font-size: 13px;
            color: var(--text-muted);
            margin-bottom: 8px;
        }

        .summary-card.highlight label {
            color: rgba(255,255,255,0.8);
        }

        .summary-card .value {
            font-size: 24px;
            font-weight: 700;
            color: var(--text-primary);
        }

        .summary-card.highlight .value {
            color: var(--white);
        }

        .summary-card .sub {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 4px;
        }

        .summary-card.highlight .sub {
            color: rgba(255,255,255,0.7);
        }

        /* RESULT TABLES */
        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
        }

        .result-table-section h3 {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .result-table {
            width: 100%;
            border-collapse: collapse;
        }

        .result-table th,
        .result-table td {
            padding: 10px 12px;
            font-size: 13px;
            border-bottom: 1px solid var(--border);
        }

        .result-table th {
            text-align: left;
            font-weight: 500;
            color: var(--text-muted);
            background: var(--bg-light);
        }

        .result-table td {
            text-align: right;
        }

        .result-table td:first-child {
            text-align: left;
            color: var(--text-secondary);
        }

        .result-table tr.total {
            font-weight: 600;
            background: var(--deep-blue-pale);
        }

        .result-table tr.total td {
            color: var(--deep-blue);
        }

        /* FOOTER */
        footer {
            background: #1E3A5F;
            color: var(--white);
            padding: 32px 40px;
            margin-top: 60px;
        }

        .footer-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .footer-logo { font-size: 18px; font-weight: 700; }
        .footer-text { font-size: 13px; opacity: 0.7; }

        /* Ïö∞Ï∏° ÏÇ¨Ïù¥ÎìúÎ∞î ÎûòÌçº */
        .sidebar-wrapper {
            width: 320px;
            flex-shrink: 0;
        }

        /* ÎßàÏù¥ ÌéòÏù¥ÏßÄ Î≤ÑÌäº */
        .btn-mypage {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
            padding: 14px;
            font-size: 15px;
            font-weight: 600;
            color: white;
            background: var(--deep-blue);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
            margin-bottom: 24px;
        }

        .btn-mypage:hover {
            background: #1E40AF;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(29, 78, 216, 0.3);
        }

        .sidebar-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 2px solid #E5E7EB;
        }

        .process-steps {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .process-step {
            padding: 12px 16px;
            border-radius: 8px;
            font-size: 14px;
            color: #6B7280;
            display: flex;
            align-items: center;
            gap: 12px;
            transition: all 0.2s ease;
        }

        .process-step:hover {
            background: #F3F4F6;
        }

        .process-step.active {
            background: #DBEAFE;
            color: #1D4ED8;
            font-weight: 600;
        }

        .step-number {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #E5E7EB;
            color: #6B7280;
            font-size: 12px;
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .process-step.active .step-number {
            background: #1D4ED8;
            color: white;
        }

        .step-text {
            flex: 1;
        }

        /* Î∞òÏùëÌòï */
        @media (max-width: 1024px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                position: static;
            }

            .method-card {
                flex-direction: column;
                text-align: center;
            }
        }

        /* MOBILE RESPONSIVE */
        @media (max-width: 768px) {
            /* Header */
            header {
                padding: 0 20px;
                height: auto;
                flex-direction: column;
                align-items: flex-start;
                padding: 16px 20px;
            }

            .header-left {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
                width: 100%;
            }

            .main-nav {
                flex-wrap: wrap;
                gap: 8px;
                width: 100%;
            }

            .nav-item {
                padding: 8px 14px;
                font-size: 13px;
            }

            /* Breadcrumb */
            .breadcrumb-container {
                padding: 10px 20px;
            }

            .breadcrumb {
                font-size: 12px;
                flex-wrap: wrap;
            }

            /* Main Content */
            .main-content {
                padding: 20px;
            }

            /* Page Title */
            .page-title {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
                margin-bottom: 24px;
            }

            .page-title-content h1 {
                font-size: 22px;
            }

            .page-title-content p {
                font-size: 14px;
            }

            /* Form Container */
            .form-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            /* Form Section */
            .form-section {
                padding: 20px;
            }

            .form-section h2 {
                font-size: 16px;
            }

            /* Form Row */
            .form-row {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .form-input {
                font-size: 16px; /* iOS ÏûêÎèô ÌôïÎåÄ Î∞©ÏßÄ */
            }

            /* Projection Table - Convert to Card */
            .projection-table {
                display: block;
                overflow-x: auto;
            }

            .projection-table th,
            .projection-table td {
                padding: 8px 6px;
                font-size: 12px;
            }

            .projection-table input {
                padding: 6px;
                font-size: 12px;
            }

            /* Buttons */
            .btn-calculate,
            .btn-portal {
                width: 100%;
                padding: 14px;
                font-size: 15px;
            }

            /* Result Section */
            .result-section {
                padding: 24px 20px;
            }

            .result-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .result-summary {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            .summary-card {
                padding: 16px;
            }

            /* Result Grid */
            .result-grid {
                grid-template-columns: 1fr;
                gap: 16px;
            }

            /* Result Table */
            .result-table {
                font-size: 12px;
            }

            .result-table th,
            .result-table td {
                padding: 8px;
            }

            /* Footer */
            footer {
                padding: 24px 20px;
            }

            .footer-content {
                flex-direction: column;
                align-items: flex-start;
                gap: 16px;
            }

            /* Sidebar */
            .sidebar {
                width: 100%;
                position: static;
                margin-top: 20px;
            }
        }

    </style>
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="header-left">
            <a href="../../../app/core/index.html" class="logo">
                <svg class="logo-symbol" viewBox="0 0 100 100">
                    <g transform="translate(15, 20)">
                        <line x1="0" y1="0" x2="35" y2="50" stroke="#166534" stroke-width="11" stroke-linecap="round"/>
                        <line x1="70" y1="0" x2="35" y2="50" stroke="#1D4ED8" stroke-width="11" stroke-linecap="round"/>
                        <line x1="35" y1="50" x2="85" y2="50" stroke="#F59E0B" stroke-width="11" stroke-linecap="round"/>
                    </g>
                </svg>
                <span class="logo-text">ValueLink</span>
            </a>
            <nav class="main-nav">
                <a href="../../../app/valuation/guides/mockup-valuation.html" class="nav-item link">ÌèâÍ∞ÄÎ∞©Î≤ï</a>
                <a href="../../../app/core/valuation-list.html" class="nav-item link">ÌîÑÎ°úÏ†ùÌä∏ Î™©Î°ù</a>
                <a href="../../../app/projects/project-create.html" class="nav-item link">Ïã†Í∑ú</a>
                <a href="../../../app/dev/deal.html" class="nav-item link">Deal</a>
            </nav>
        </div>
    </header>

    <!-- BREADCRUMB -->
    <div class="breadcrumb-container">
        <div class="breadcrumb">
            <a href="../../../app/core/index.html">Ìôà</a>
            <span>></span>
            <a href="../guides/mockup-valuation.html">ÌèâÍ∞ÄÎ∞©Î≤ï</a>
            <span>></span>
            <span>DCFÌèâÍ∞ÄÎ≤ï</span>
        </div>
    </div>

        <!-- MAIN -->
        <div class="container">
            <div class="main-area">
                <div class="page-title">
                    <div class="page-title-content">
                        <h1>DCF Í∏∞ÏóÖÍ∞ÄÏπò ÌèâÍ∞Ä</h1>
                        <p>ÌòÑÍ∏àÌùêÎ¶ÑÌï†Ïù∏Î≤ï(Discounted Cash Flow)ÏúºÎ°ú Í∏∞ÏóÖÏùò Î≥∏ÏßàÍ∞ÄÏπòÎ•º ÏÇ∞Ï†ïÌï©ÎãàÎã§</p>
                    </div>
                    <a href="dcf-portal.html" class="btn-portal">
                        <span>üìÅ</span> ÏûêÎ£å ÏóÖÎ°úÎìú
                    </a>
                </div>
    
                <div class="form-container">
                    <!-- Í∏∞Î≥∏ Ï†ïÎ≥¥ -->
                    <div class="form-section">
                        <h2>Í∏∞Î≥∏ Ï†ïÎ≥¥</h2>
                        <div class="form-group">
                            <label>ÌöåÏÇ¨Î™Ö</label>
                            <input type="text" id="companyName" placeholder="ÌèâÍ∞Ä ÎåÄÏÉÅ ÌöåÏÇ¨Î™Ö">
                        </div>
                        <div class="form-group">
                            <label>ÌèâÍ∞Ä Í∏∞Ï§ÄÏùº</label>
                            <input type="date" id="valuationDate" value="2025-01-01">
                        </div>
                        <div class="form-group">
                            <label>Î∞úÌñâÏ£ºÏãùÏàò</label>
                            <input type="number" id="sharesOutstanding" placeholder="1,000,000" value="1000000">
                            <div class="unit">Ï£º</div>
                        </div>
                    </div>
    
                    <!-- Ìï†Ïù∏Ïú® (WACC) -->
                    <div class="form-section">
                        <h2>Ìï†Ïù∏Ïú® (WACC)</h2>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Î¨¥ÏúÑÌóòÏù¥ÏûêÏú® (Rf)</label>
                                <input type="number" id="riskFreeRate" step="0.01" value="3.5" placeholder="3.5">
                                <div class="unit">%</div>
                            </div>
                            <div class="form-group">
                                <label>ÏãúÏû•ÏúÑÌóòÌîÑÎ¶¨ÎØ∏ÏóÑ (MRP)</label>
                                <input type="number" id="marketRiskPremium" step="0.01" value="6.0" placeholder="6.0">
                                <div class="unit">%</div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Î†àÎ≤ÑÎ¶¨ÏßÄ Î≤†ÌÉÄ (Œ≤)</label>
                                <input type="number" id="leveredBeta" step="0.01" value="1.2" placeholder="1.2">
                            </div>
                            <div class="form-group">
                                <label>Í∑úÎ™® ÌîÑÎ¶¨ÎØ∏ÏóÑ</label>
                                <input type="number" id="sizePremium" step="0.01" value="2.0" placeholder="2.0">
                                <div class="unit">%</div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>ÏÑ∏Ï†Ñ ÌÉÄÏù∏ÏûêÎ≥∏ÎπÑÏö©</label>
                                <input type="number" id="costOfDebt" step="0.01" value="5.0" placeholder="5.0">
                                <div class="unit">%</div>
                            </div>
                            <div class="form-group">
                                <label>Î≤ïÏù∏ÏÑ∏Ïú®</label>
                                <input type="number" id="taxRate" step="0.01" value="22.0" placeholder="22.0">
                                <div class="unit">%</div>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>ÏûêÍ∏∞ÏûêÎ≥∏ ÎπÑÏ§ë</label>
                                <input type="number" id="equityRatio" step="0.01" value="70.0" placeholder="70.0">
                                <div class="unit">%</div>
                            </div>
                            <div class="form-group">
                                <label>ÌÉÄÏù∏ÏûêÎ≥∏ ÎπÑÏ§ë</label>
                                <input type="number" id="debtRatio" step="0.01" value="30.0" placeholder="30.0">
                                <div class="unit">%</div>
                            </div>
                        </div>
                        <div class="form-group" style="margin-top: 16px; padding: 12px; background: var(--deep-blue-pale); border-radius: 8px;">
                            <label style="color: var(--deep-blue);">Í≥ÑÏÇ∞Îêú WACC</label>
                            <div style="font-size: 24px; font-weight: 700; color: var(--deep-blue);" id="calculatedWacc">12.87%</div>
                        </div>
                    </div>
    
                    <!-- FCFF Ï∂îÏ†ï (5ÎÖÑ) -->
                    <div class="form-section" style="grid-column: 1 / -1;">
                        <h2>FCFF Ï∂îÏ†ï (5Í∞úÎÖÑ)</h2>
                        <table class="projection-table">
                            <thead>
                                <tr>
                                    <th>Ìï≠Î™©</th>
                                    <th>1ÎÖÑÏ∞®</th>
                                    <th>2ÎÖÑÏ∞®</th>
                                    <th>3ÎÖÑÏ∞®</th>
                                    <th>4ÎÖÑÏ∞®</th>
                                    <th>5ÎÖÑÏ∞®</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Îß§Ï∂úÏï°</td>
                                    <td><input type="number" id="revenue1" value="10000000000"></td>
                                    <td><input type="number" id="revenue2" value="12000000000"></td>
                                    <td><input type="number" id="revenue3" value="14400000000"></td>
                                    <td><input type="number" id="revenue4" value="17280000000"></td>
                                    <td><input type="number" id="revenue5" value="20736000000"></td>
                                </tr>
                                <tr>
                                    <td>EBIT</td>
                                    <td><input type="number" id="ebit1" value="1500000000"></td>
                                    <td><input type="number" id="ebit2" value="1800000000"></td>
                                    <td><input type="number" id="ebit3" value="2160000000"></td>
                                    <td><input type="number" id="ebit4" value="2592000000"></td>
                                    <td><input type="number" id="ebit5" value="3110400000"></td>
                                </tr>
                                <tr>
                                    <td>Í∞êÍ∞ÄÏÉÅÍ∞ÅÎπÑ</td>
                                    <td><input type="number" id="dep1" value="500000000"></td>
                                    <td><input type="number" id="dep2" value="550000000"></td>
                                    <td><input type="number" id="dep3" value="600000000"></td>
                                    <td><input type="number" id="dep4" value="650000000"></td>
                                    <td><input type="number" id="dep5" value="700000000"></td>
                                </tr>
                                <tr>
                                    <td>CAPEX</td>
                                    <td><input type="number" id="capex1" value="600000000"></td>
                                    <td><input type="number" id="capex2" value="700000000"></td>
                                    <td><input type="number" id="capex3" value="800000000"></td>
                                    <td><input type="number" id="capex4" value="900000000"></td>
                                    <td><input type="number" id="capex5" value="1000000000"></td>
                                </tr>
                                <tr>
                                    <td>Ïö¥Ï†ÑÏûêÎ≥∏ Ï¶ùÍ∞ê</td>
                                    <td><input type="number" id="wc1" value="200000000"></td>
                                    <td><input type="number" id="wc2" value="240000000"></td>
                                    <td><input type="number" id="wc3" value="288000000"></td>
                                    <td><input type="number" id="wc4" value="345600000"></td>
                                    <td><input type="number" id="wc5" value="414720000"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
    
                    <!-- ÏòÅÍµ¨ÏÑ±Ïû•Î•† Î∞è ÎπÑÏòÅÏóÖ Ìï≠Î™© -->
                    <div class="form-section">
                        <h2>Terminal Value</h2>
                        <div class="form-group">
                            <label>ÏòÅÍµ¨ÏÑ±Ïû•Î•†</label>
                            <input type="number" id="terminalGrowth" step="0.01" value="1.0" placeholder="1.0">
                            <div class="unit">%</div>
                        </div>
                    </div>
    
                    <div class="form-section">
                        <h2>ÎπÑÏòÅÏóÖ Ìï≠Î™©</h2>
                        <div class="form-group">
                            <label>ÎπÑÏòÅÏóÖÏûêÏÇ∞</label>
                            <input type="number" id="nonOperatingAssets" value="500000000" placeholder="0">
                            <div class="unit">Ïõê</div>
                        </div>
                        <div class="form-group">
                            <label>Ïù¥ÏûêÎ∂ÄÎ∂ÄÏ±Ñ</label>
                            <input type="number" id="interestBearingDebt" value="2000000000" placeholder="0">
                            <div class="unit">Ïõê</div>
                        </div>
                    </div>
    
                    <!-- Í≥ÑÏÇ∞ Î≤ÑÌäº -->
                    <div style="grid-column: 1 / -1;">
                        <button class="btn-calculate" onclick="calculateDCF()">Í∏∞ÏóÖÍ∞ÄÏπò ÌèâÍ∞Ä Ïã§Ìñâ</button>
                    </div>
    
                    <!-- Í≤∞Í≥º ÏÑπÏÖò -->
                    <div class="result-section" id="resultSection">
                        <div class="result-header">
                            <h2>DCF ÌèâÍ∞Ä Í≤∞Í≥º</h2>
                            <span id="resultCompanyName"></span>
                        </div>
    
                        <div class="result-summary">
                            <div class="summary-card">
                                <label>ÏòÅÏóÖÍ∞ÄÏπò</label>
                                <div class="value" id="resultOperatingValue">-</div>
                                <div class="sub">Operating Value</div>
                            </div>
                            <div class="summary-card">
                                <label>Í∏∞ÏóÖÍ∞ÄÏπò</label>
                                <div class="value" id="resultEnterpriseValue">-</div>
                                <div class="sub">Enterprise Value</div>
                            </div>
                            <div class="summary-card">
                                <label>Ï£ºÏãùÍ∞ÄÏπò</label>
                                <div class="value" id="resultEquityValue">-</div>
                                <div class="sub">Equity Value</div>
                            </div>
                            <div class="summary-card highlight">
                                <label>Ï£ºÎãπÍ∞ÄÏπò</label>
                                <div class="value" id="resultPerShare">-</div>
                                <div class="sub">Value per Share</div>
                            </div>
                        </div>
    
                        <div class="result-grid">
                            <div class="result-table-section">
                                <h3>FCFF ÌòÑÏû¨Í∞ÄÏπò</h3>
                                <table class="result-table">
                                    <thead>
                                        <tr>
                                            <th>Ïó∞ÎèÑ</th>
                                            <th>FCFF</th>
                                            <th>Ìï†Ïù∏Í≥ÑÏàò</th>
                                            <th>ÌòÑÏû¨Í∞ÄÏπò</th>
                                        </tr>
                                    </thead>
                                    <tbody id="fcffTableBody">
                                    </tbody>
                                </table>
                            </div>
    
                            <div class="result-table-section">
                                <h3>Í∞ÄÏπò ÏÇ∞Ï∂ú</h3>
                                <table class="result-table">
                                    <thead>
                                        <tr>
                                            <th>Ìï≠Î™©</th>
                                            <th>Í∏àÏï°</th>
                                        </tr>
                                    </thead>
                                    <tbody id="valueTableBody">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    
            <!-- Ïö∞Ï∏° ÏÇ¨Ïù¥ÎìúÎ∞î (14Îã®Í≥Ñ ÌîÑÎ°úÏÑ∏Ïä§) -->
            <aside id="sidebar-container" class="sidebar-wrapper">
                <!-- Í≥µÌÜµ ÏÇ¨Ïù¥ÎìúÎ∞î Ïª¥Ìè¨ÎÑåÌä∏Í∞Ä Ïó¨Í∏∞Ïóê Ï£ºÏûÖÎê® -->
            </aside>
        </div>
    <footer>
        <div class="footer-content">
            <div class="footer-logo">ValueLink</div>
            <div class="footer-text">¬© 2025 ValueLink. All rights reserved.</div>
        </div>
    </footer>

    <script>
        // WACC Ïã§ÏãúÍ∞Ñ Í≥ÑÏÇ∞
        function updateWacc() {
            const rf = parseFloat(document.getElementById('riskFreeRate').value) / 100 || 0;
            const mrp = parseFloat(document.getElementById('marketRiskPremium').value) / 100 || 0;
            const beta = parseFloat(document.getElementById('leveredBeta').value) || 0;
            const sizePremium = parseFloat(document.getElementById('sizePremium').value) / 100 || 0;
            const costOfDebt = parseFloat(document.getElementById('costOfDebt').value) / 100 || 0;
            const taxRate = parseFloat(document.getElementById('taxRate').value) / 100 || 0;
            const equityRatio = parseFloat(document.getElementById('equityRatio').value) / 100 || 0;
            const debtRatio = parseFloat(document.getElementById('debtRatio').value) / 100 || 0;

            // Cost of Equity (CAPM)
            const costOfEquity = rf + (beta * mrp) + sizePremium;

            // After-tax Cost of Debt
            const afterTaxCostOfDebt = costOfDebt * (1 - taxRate);

            // WACC
            const wacc = (equityRatio * costOfEquity) + (debtRatio * afterTaxCostOfDebt);

            document.getElementById('calculatedWacc').textContent = (wacc * 100).toFixed(2) + '%';
            return wacc;
        }

        // WACC Í¥ÄÎ†® ÏûÖÎ†• ÌïÑÎìúÏóê Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
        ['riskFreeRate', 'marketRiskPremium', 'leveredBeta', 'sizePremium',
         'costOfDebt', 'taxRate', 'equityRatio', 'debtRatio'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateWacc);
        });

        // Ïà´Ïûê Ìè¨Îß∑ÌåÖ
        function formatNumber(num) {
            if (num >= 1000000000000) {
                return (num / 1000000000000).toFixed(2) + 'Ï°∞';
            } else if (num >= 100000000) {
                return (num / 100000000).toFixed(0) + 'Ïñµ';
            } else if (num >= 10000) {
                return (num / 10000).toFixed(0) + 'Îßå';
            }
            return num.toLocaleString();
        }

        function formatWon(num) {
            return num.toLocaleString() + 'Ïõê';
        }

        // DCF Í≥ÑÏÇ∞
        function calculateDCF() {
            const wacc = updateWacc();
            const taxRate = parseFloat(document.getElementById('taxRate').value) / 100;
            const terminalGrowth = parseFloat(document.getElementById('terminalGrowth').value) / 100;
            const sharesOutstanding = parseInt(document.getElementById('sharesOutstanding').value);
            const nonOperatingAssets = parseFloat(document.getElementById('nonOperatingAssets').value) || 0;
            const interestBearingDebt = parseFloat(document.getElementById('interestBearingDebt').value) || 0;

            // FCFF Í≥ÑÏÇ∞ (Í∞Å Ïó∞ÎèÑ)
            const fcffData = [];
            let pvCumulative = 0;

            for (let i = 1; i <= 5; i++) {
                const ebit = parseFloat(document.getElementById(`ebit${i}`).value) || 0;
                const dep = parseFloat(document.getElementById(`dep${i}`).value) || 0;
                const capex = parseFloat(document.getElementById(`capex${i}`).value) || 0;
                const wc = parseFloat(document.getElementById(`wc${i}`).value) || 0;

                const nopat = ebit * (1 - taxRate);
                const fcff = nopat + dep - capex - wc;
                const discountFactor = 1 / Math.pow(1 + wacc, i);
                const pv = fcff * discountFactor;

                pvCumulative += pv;

                fcffData.push({
                    year: i + 'ÎÖÑÏ∞®',
                    fcff: fcff,
                    discountFactor: discountFactor,
                    pv: pv
                });
            }

            // Terminal Value
            const lastFcff = fcffData[4].fcff;
            const terminalFcff = lastFcff * (1 + terminalGrowth);
            const terminalValue = terminalFcff / (wacc - terminalGrowth);
            const pvTerminal = terminalValue / Math.pow(1 + wacc, 5);

            // Í∞ÄÏπò Í≥ÑÏÇ∞
            const operatingValue = pvCumulative + pvTerminal;
            const enterpriseValue = operatingValue + nonOperatingAssets;
            const equityValue = enterpriseValue - interestBearingDebt;
            const valuePerShare = equityValue / sharesOutstanding;

            // Í≤∞Í≥º ÌëúÏãú
            document.getElementById('resultSection').classList.add('show');
            document.getElementById('resultCompanyName').textContent =
                document.getElementById('companyName').value || 'ÌèâÍ∞Ä ÎåÄÏÉÅ Í∏∞ÏóÖ';

            document.getElementById('resultOperatingValue').textContent = formatNumber(operatingValue);
            document.getElementById('resultEnterpriseValue').textContent = formatNumber(enterpriseValue);
            document.getElementById('resultEquityValue').textContent = formatNumber(equityValue);
            document.getElementById('resultPerShare').textContent = Math.round(valuePerShare).toLocaleString() + 'Ïõê';

            // FCFF ÌÖåÏù¥Î∏î
            let fcffHtml = '';
            fcffData.forEach(data => {
                fcffHtml += `
                    <tr>
                        <td>${data.year}</td>
                        <td>${formatNumber(data.fcff)}</td>
                        <td>${data.discountFactor.toFixed(4)}</td>
                        <td>${formatNumber(data.pv)}</td>
                    </tr>
                `;
            });
            fcffHtml += `
                <tr>
                    <td>Terminal</td>
                    <td>${formatNumber(terminalValue)}</td>
                    <td>${(1 / Math.pow(1 + wacc, 5)).toFixed(4)}</td>
                    <td>${formatNumber(pvTerminal)}</td>
                </tr>
                <tr class="total">
                    <td>Ìï©Í≥Ñ</td>
                    <td>-</td>
                    <td>-</td>
                    <td>${formatNumber(pvCumulative + pvTerminal)}</td>
                </tr>
            `;
            document.getElementById('fcffTableBody').innerHTML = fcffHtml;

            // Í∞ÄÏπò ÏÇ∞Ï∂ú ÌÖåÏù¥Î∏î
            const valueHtml = `
                <tr>
                    <td>FCFF ÌòÑÏû¨Í∞ÄÏπò Ìï©Í≥Ñ</td>
                    <td>${formatNumber(pvCumulative)}</td>
                </tr>
                <tr>
                    <td>Terminal Value ÌòÑÏû¨Í∞ÄÏπò</td>
                    <td>${formatNumber(pvTerminal)}</td>
                </tr>
                <tr class="total">
                    <td>ÏòÅÏóÖÍ∞ÄÏπò</td>
                    <td>${formatNumber(operatingValue)}</td>
                </tr>
                <tr>
                    <td>(+) ÎπÑÏòÅÏóÖÏûêÏÇ∞</td>
                    <td>${formatNumber(nonOperatingAssets)}</td>
                </tr>
                <tr class="total">
                    <td>Í∏∞ÏóÖÍ∞ÄÏπò</td>
                    <td>${formatNumber(enterpriseValue)}</td>
                </tr>
                <tr>
                    <td>(-) Ïù¥ÏûêÎ∂ÄÎ∂ÄÏ±Ñ</td>
                    <td>${formatNumber(interestBearingDebt)}</td>
                </tr>
                <tr class="total">
                    <td>Ï£ºÏãùÍ∞ÄÏπò</td>
                    <td>${formatNumber(equityValue)}</td>
                </tr>
                <tr>
                    <td>Î∞úÌñâÏ£ºÏãùÏàò</td>
                    <td>${sharesOutstanding.toLocaleString()}Ï£º</td>
                </tr>
                <tr class="total">
                    <td>Ï£ºÎãπÍ∞ÄÏπò</td>
                    <td>${Math.round(valuePerShare).toLocaleString()}Ïõê</td>
                </tr>
            `;
            document.getElementById('valueTableBody').innerHTML = valueHtml;

            // Í≤∞Í≥º ÏÑπÏÖòÏúºÎ°ú Ïä§ÌÅ¨Î°§
            document.getElementById('resultSection').scrollIntoView({ behavior: 'smooth' });
        }

        // Ï¥àÍ∏∞ WACC Í≥ÑÏÇ∞
        updateWacc();
    </script>

    <!-- ÏÇ¨Ïù¥ÎìúÎ∞î Ï¥àÍ∏∞Ìôî -->
    <script type="module">
        import { injectSidebar } from '../../components/common-sidebar.js';
        import { getCurrentProject, STATUS } from '../../components/project-status-checker.js';

        async function initSidebar() {
            // DCF ÌèâÍ∞ÄÎ≤ï ÌôîÎ©¥
            // URLÏóêÏÑú projectId Í∞ÄÏ†∏Ïò§Í∏∞
            const urlParams = new URLSearchParams(window.location.search);
            const projectId = urlParams.get('projectId');
            const method = urlParams.get('method') || 'dcf';

            // ÌîÑÎ°úÏ†ùÌä∏ ÌôïÏù∏
            const project = await getCurrentProject();

            if (project && project.project_id === projectId) {
                // ÌòÑÏû¨ Îã®Í≥Ñ Í≤∞Ï†ï (ÌèâÍ∞Ä Í≤∞Í≥º ÌéòÏù¥ÏßÄÎäî 6Îã®Í≥Ñ)
                const currentStep = project.current_step || 6;

                injectSidebar(
                    'sidebar-container',
                    currentStep,
                    STATUS.IN_PROGRESS,  // ÌèâÍ∞Ä ÏßÑÌñâ Ï§ë
                    method,              // DCF
                    projectId
                );
            } else {
                // ÌîÑÎ°úÏ†ùÌä∏ ÏóÜÏùå (ÎØ∏Î¶¨Î≥¥Í∏∞ Î™®Îìú)
                injectSidebar(
                    'sidebar-container',
                    6,                   // 6Îã®Í≥Ñ (ÌèâÍ∞Ä ÏßÑÌñâ Ï§ë)
                    STATUS.IN_PROGRESS,
                    'dcf',
                    null
                );
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú ÏÇ¨Ïù¥ÎìúÎ∞î Ï¥àÍ∏∞Ìôî
        initSidebar();
    </script>
</body>
</html>
